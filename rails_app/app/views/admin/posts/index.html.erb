<div class="d-flex justify-content-between align-items-center mb-4">
  <h1><i class="bi bi-file-earmark-text me-2"></i> Posty</h1>
  <%= link_to new_admin_post_path, class: "btn btn-primary" do %>
    <i class="bi bi-plus-circle me-2"></i> Dodaj nowy post
  <% end %>
</div>

<div class="row row-cols-1 row-cols-md-3 g-4">
  <% @posts.each do |post| %> 
    <div class="col">
      <div class="card h-100">
        <% first_image = extract_first_image(post.body) %>
        <% if first_image %>
          <%= image_tag first_image, class: "card-img-top", style: "height: 200px; object-fit: cover;" %>
        <% else %>
          <div class="card-img-top bg-light d-flex align-items-center justify-content-center" style="height: 200px;">
            <span class="text-muted">Brak zdjęcia</span>
          </div>
        <% end %>

        <div class="card-body">
          <h5 class="card-title"><%= post.title %></h5>
          <p class="card-text text-muted small">
            <i class="bi bi-calendar me-1"></i> <%= l post.created_at, format: :short %>
          </p>
          
          <div class="d-flex flex-wrap gap-2 mt-3">
            <%= link_to admin_post_path(post), class: "btn btn-sm btn-outline-primary" do %>
              <i class="bi bi-eye me-1"></i> Pokaż
            <% end %>
            <%= link_to edit_admin_post_path(post), class: "btn btn-sm btn-outline-secondary" do %>
              <i class="bi bi-pencil me-1"></i> Edytuj
            <% end %>
            <%= button_to admin_post_path(post), 
                method: :delete,
                form: { data: { turbo_confirm: "Czy na pewno chcesz usunąć ten post?" } },
                class: "btn btn-sm btn-outline-danger" do %>
              <i class="bi bi-trash me-1"></i> Usuń
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>

<% unless defined?(@skip_pagination) && @skip_pagination %>
  <%= paginate @posts %>
<% end %>
