<% content_for :title, "Posts" %>

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
  <h1 class="h2">Posty</h1>
</div>

<div class="row" id="posts">
  <% @posts.order(created_at: :desc).each do |post| %>
    <div class="col-md-6 col-lg-4 mb-4">
      <div class="card h-100">
        <% first_image = extract_first_image(post.body) %>
        <% if first_image %>
          <div class="card-img-top">
            <%= image_tag first_image, class: "img-fluid w-100", style: "height: 200px; object-fit: cover;" %>
          </div>
        <% else %>
          <div class="card-img-top bg-light d-flex align-items-center justify-content-center" style="height: 200px;">
            <span class="text-muted">Brak zdjęcia</span>
          </div>
        <% end %>

        <div class="card-body">
          <h5 class="card-title"><%= post.title %></h5>
          <p class="card-text text-muted small">
            <i class="bi bi-calendar"></i> <%= l post.created_at, format: :short %>
          </p>
          <p class="card-text">
            <%= truncate(post.body.to_plain_text, length: 100) rescue "Brak treści" %>
          </p>
          <%= link_to "Show this post", post, class: "btn btn-primary" %>
        </div>
      </div>
    </div>
  <% end %>
</div>
